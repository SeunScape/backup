{"ast":null,"code":"//import warning from 'warning'\n'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nvar _deepEqual = require('deep-equal');\n\nvar _deepEqual2 = _interopRequireDefault(_deepEqual);\n\nvar _AsyncUtils = require('./AsyncUtils');\n\nvar _Actions = require('./Actions');\n\nvar _createLocation2 = require('./createLocation');\n\nvar _createLocation3 = _interopRequireDefault(_createLocation2);\n\nvar _runTransitionHook = require('./runTransitionHook');\n\nvar _runTransitionHook2 = _interopRequireDefault(_runTransitionHook);\n\nvar _parsePath = require('./parsePath');\n\nvar _parsePath2 = _interopRequireDefault(_parsePath);\n\nvar _deprecate = require('./deprecate');\n\nvar _deprecate2 = _interopRequireDefault(_deprecate);\n\nfunction createRandomKey(length) {\n  return Math.random().toString(36).substr(2, length);\n}\n\nfunction locationsAreEqual(a, b) {\n  return a.pathname === b.pathname && a.search === b.search && //a.action === b.action && // Different action !== location change.\n  a.key === b.key && _deepEqual2['default'](a.state, b.state);\n}\n\nvar DefaultKeyLength = 6;\n\nfunction createHistory() {\n  var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n  var getCurrentLocation = options.getCurrentLocation;\n  var finishTransition = options.finishTransition;\n  var saveState = options.saveState;\n  var go = options.go;\n  var keyLength = options.keyLength;\n  var getUserConfirmation = options.getUserConfirmation;\n  if (typeof keyLength !== 'number') keyLength = DefaultKeyLength;\n  var transitionHooks = [];\n\n  function listenBefore(hook) {\n    transitionHooks.push(hook);\n    return function () {\n      transitionHooks = transitionHooks.filter(function (item) {\n        return item !== hook;\n      });\n    };\n  }\n\n  var allKeys = [];\n  var changeListeners = [];\n  var location = undefined;\n\n  function getCurrent() {\n    if (pendingLocation && pendingLocation.action === _Actions.POP) {\n      return allKeys.indexOf(pendingLocation.key);\n    } else if (location) {\n      return allKeys.indexOf(location.key);\n    } else {\n      return -1;\n    }\n  }\n\n  function updateLocation(newLocation) {\n    var current = getCurrent();\n    location = newLocation;\n\n    if (location.action === _Actions.PUSH) {\n      allKeys = [].concat(allKeys.slice(0, current + 1), [location.key]);\n    } else if (location.action === _Actions.REPLACE) {\n      allKeys[current] = location.key;\n    }\n\n    changeListeners.forEach(function (listener) {\n      listener(location);\n    });\n  }\n\n  function listen(listener) {\n    changeListeners.push(listener);\n\n    if (location) {\n      listener(location);\n    } else {\n      var _location = getCurrentLocation();\n\n      allKeys = [_location.key];\n      updateLocation(_location);\n    }\n\n    return function () {\n      changeListeners = changeListeners.filter(function (item) {\n        return item !== listener;\n      });\n    };\n  }\n\n  function confirmTransitionTo(location, callback) {\n    _AsyncUtils.loopAsync(transitionHooks.length, function (index, next, done) {\n      _runTransitionHook2['default'](transitionHooks[index], location, function (result) {\n        if (result != null) {\n          done(result);\n        } else {\n          next();\n        }\n      });\n    }, function (message) {\n      if (getUserConfirmation && typeof message === 'string') {\n        getUserConfirmation(message, function (ok) {\n          callback(ok !== false);\n        });\n      } else {\n        callback(message !== false);\n      }\n    });\n  }\n\n  var pendingLocation = undefined;\n\n  function transitionTo(nextLocation) {\n    if (location && locationsAreEqual(location, nextLocation)) return; // Nothing to do.\n\n    pendingLocation = nextLocation;\n    confirmTransitionTo(nextLocation, function (ok) {\n      if (pendingLocation !== nextLocation) return; // Transition was interrupted.\n\n      if (ok) {\n        // treat PUSH to current path like REPLACE to be consistent with browsers\n        if (nextLocation.action === _Actions.PUSH) {\n          var prevPath = createPath(location);\n          var nextPath = createPath(nextLocation);\n          if (nextPath === prevPath) nextLocation.action = _Actions.REPLACE;\n        }\n\n        if (finishTransition(nextLocation) !== false) updateLocation(nextLocation);\n      } else if (location && nextLocation.action === _Actions.POP) {\n        var prevIndex = allKeys.indexOf(location.key);\n        var nextIndex = allKeys.indexOf(nextLocation.key);\n        if (prevIndex !== -1 && nextIndex !== -1) go(prevIndex - nextIndex); // Restore the URL.\n      }\n    });\n  }\n\n  function push(location) {\n    transitionTo(createLocation(location, _Actions.PUSH, createKey()));\n  }\n\n  function replace(location) {\n    transitionTo(createLocation(location, _Actions.REPLACE, createKey()));\n  }\n\n  function goBack() {\n    go(-1);\n  }\n\n  function goForward() {\n    go(1);\n  }\n\n  function createKey() {\n    return createRandomKey(keyLength);\n  }\n\n  function createPath(location) {\n    if (location == null || typeof location === 'string') return location;\n    var pathname = location.pathname;\n    var search = location.search;\n    var hash = location.hash;\n    var result = pathname;\n    if (search) result += search;\n    if (hash) result += hash;\n    return result;\n  }\n\n  function createHref(location) {\n    return createPath(location);\n  }\n\n  function createLocation(location, action) {\n    var key = arguments.length <= 2 || arguments[2] === undefined ? createKey() : arguments[2];\n\n    if (typeof action === 'object') {\n      //warning(\n      //  false,\n      //  'The state (2nd) argument to history.createLocation is deprecated; use a ' +\n      //  'location descriptor instead'\n      //)\n      if (typeof location === 'string') location = _parsePath2['default'](location);\n      location = _extends({}, location, {\n        state: action\n      });\n      action = key;\n      key = arguments[3] || createKey();\n    }\n\n    return _createLocation3['default'](location, action, key);\n  } // deprecated\n\n\n  function setState(state) {\n    if (location) {\n      updateLocationState(location, state);\n      updateLocation(location);\n    } else {\n      updateLocationState(getCurrentLocation(), state);\n    }\n  }\n\n  function updateLocationState(location, state) {\n    location.state = _extends({}, location.state, state);\n    saveState(location.key, location.state);\n  } // deprecated\n\n\n  function registerTransitionHook(hook) {\n    if (transitionHooks.indexOf(hook) === -1) transitionHooks.push(hook);\n  } // deprecated\n\n\n  function unregisterTransitionHook(hook) {\n    transitionHooks = transitionHooks.filter(function (item) {\n      return item !== hook;\n    });\n  } // deprecated\n\n\n  function pushState(state, path) {\n    if (typeof path === 'string') path = _parsePath2['default'](path);\n    push(_extends({\n      state: state\n    }, path));\n  } // deprecated\n\n\n  function replaceState(state, path) {\n    if (typeof path === 'string') path = _parsePath2['default'](path);\n    replace(_extends({\n      state: state\n    }, path));\n  }\n\n  return {\n    listenBefore: listenBefore,\n    listen: listen,\n    transitionTo: transitionTo,\n    push: push,\n    replace: replace,\n    go: go,\n    goBack: goBack,\n    goForward: goForward,\n    createKey: createKey,\n    createPath: createPath,\n    createHref: createHref,\n    createLocation: createLocation,\n    setState: _deprecate2['default'](setState, 'setState is deprecated; use location.key to save state instead'),\n    registerTransitionHook: _deprecate2['default'](registerTransitionHook, 'registerTransitionHook is deprecated; use listenBefore instead'),\n    unregisterTransitionHook: _deprecate2['default'](unregisterTransitionHook, 'unregisterTransitionHook is deprecated; use the callback returned from listenBefore instead'),\n    pushState: _deprecate2['default'](pushState, 'pushState is deprecated; use push instead'),\n    replaceState: _deprecate2['default'](replaceState, 'replaceState is deprecated; use replace instead')\n  };\n}\n\nexports['default'] = createHistory;\nmodule.exports = exports['default'];","map":{"version":3,"sources":["C:/Flippay/node_modules/history/lib/createHistory.js"],"names":["exports","__esModule","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_interopRequireDefault","obj","_deepEqual","require","_deepEqual2","_AsyncUtils","_Actions","_createLocation2","_createLocation3","_runTransitionHook","_runTransitionHook2","_parsePath","_parsePath2","_deprecate","_deprecate2","createRandomKey","Math","random","toString","substr","locationsAreEqual","a","b","pathname","search","state","DefaultKeyLength","createHistory","options","undefined","getCurrentLocation","finishTransition","saveState","go","keyLength","getUserConfirmation","transitionHooks","listenBefore","hook","push","filter","item","allKeys","changeListeners","location","getCurrent","pendingLocation","action","POP","indexOf","updateLocation","newLocation","current","PUSH","concat","slice","REPLACE","forEach","listener","listen","_location","confirmTransitionTo","callback","loopAsync","index","next","done","result","message","ok","transitionTo","nextLocation","prevPath","createPath","nextPath","prevIndex","nextIndex","createLocation","createKey","replace","goBack","goForward","hash","createHref","setState","updateLocationState","registerTransitionHook","unregisterTransitionHook","pushState","path","replaceState","module"],"mappings":"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","sourcesContent":["//import warning from 'warning'\n'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar _deepEqual = require('deep-equal');\n\nvar _deepEqual2 = _interopRequireDefault(_deepEqual);\n\nvar _AsyncUtils = require('./AsyncUtils');\n\nvar _Actions = require('./Actions');\n\nvar _createLocation2 = require('./createLocation');\n\nvar _createLocation3 = _interopRequireDefault(_createLocation2);\n\nvar _runTransitionHook = require('./runTransitionHook');\n\nvar _runTransitionHook2 = _interopRequireDefault(_runTransitionHook);\n\nvar _parsePath = require('./parsePath');\n\nvar _parsePath2 = _interopRequireDefault(_parsePath);\n\nvar _deprecate = require('./deprecate');\n\nvar _deprecate2 = _interopRequireDefault(_deprecate);\n\nfunction createRandomKey(length) {\n  return Math.random().toString(36).substr(2, length);\n}\n\nfunction locationsAreEqual(a, b) {\n  return a.pathname === b.pathname && a.search === b.search &&\n  //a.action === b.action && // Different action !== location change.\n  a.key === b.key && _deepEqual2['default'](a.state, b.state);\n}\n\nvar DefaultKeyLength = 6;\n\nfunction createHistory() {\n  var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n  var getCurrentLocation = options.getCurrentLocation;\n  var finishTransition = options.finishTransition;\n  var saveState = options.saveState;\n  var go = options.go;\n  var keyLength = options.keyLength;\n  var getUserConfirmation = options.getUserConfirmation;\n\n  if (typeof keyLength !== 'number') keyLength = DefaultKeyLength;\n\n  var transitionHooks = [];\n\n  function listenBefore(hook) {\n    transitionHooks.push(hook);\n\n    return function () {\n      transitionHooks = transitionHooks.filter(function (item) {\n        return item !== hook;\n      });\n    };\n  }\n\n  var allKeys = [];\n  var changeListeners = [];\n  var location = undefined;\n\n  function getCurrent() {\n    if (pendingLocation && pendingLocation.action === _Actions.POP) {\n      return allKeys.indexOf(pendingLocation.key);\n    } else if (location) {\n      return allKeys.indexOf(location.key);\n    } else {\n      return -1;\n    }\n  }\n\n  function updateLocation(newLocation) {\n    var current = getCurrent();\n\n    location = newLocation;\n\n    if (location.action === _Actions.PUSH) {\n      allKeys = [].concat(allKeys.slice(0, current + 1), [location.key]);\n    } else if (location.action === _Actions.REPLACE) {\n      allKeys[current] = location.key;\n    }\n\n    changeListeners.forEach(function (listener) {\n      listener(location);\n    });\n  }\n\n  function listen(listener) {\n    changeListeners.push(listener);\n\n    if (location) {\n      listener(location);\n    } else {\n      var _location = getCurrentLocation();\n      allKeys = [_location.key];\n      updateLocation(_location);\n    }\n\n    return function () {\n      changeListeners = changeListeners.filter(function (item) {\n        return item !== listener;\n      });\n    };\n  }\n\n  function confirmTransitionTo(location, callback) {\n    _AsyncUtils.loopAsync(transitionHooks.length, function (index, next, done) {\n      _runTransitionHook2['default'](transitionHooks[index], location, function (result) {\n        if (result != null) {\n          done(result);\n        } else {\n          next();\n        }\n      });\n    }, function (message) {\n      if (getUserConfirmation && typeof message === 'string') {\n        getUserConfirmation(message, function (ok) {\n          callback(ok !== false);\n        });\n      } else {\n        callback(message !== false);\n      }\n    });\n  }\n\n  var pendingLocation = undefined;\n\n  function transitionTo(nextLocation) {\n    if (location && locationsAreEqual(location, nextLocation)) return; // Nothing to do.\n\n    pendingLocation = nextLocation;\n\n    confirmTransitionTo(nextLocation, function (ok) {\n      if (pendingLocation !== nextLocation) return; // Transition was interrupted.\n\n      if (ok) {\n        // treat PUSH to current path like REPLACE to be consistent with browsers\n        if (nextLocation.action === _Actions.PUSH) {\n          var prevPath = createPath(location);\n          var nextPath = createPath(nextLocation);\n\n          if (nextPath === prevPath) nextLocation.action = _Actions.REPLACE;\n        }\n\n        if (finishTransition(nextLocation) !== false) updateLocation(nextLocation);\n      } else if (location && nextLocation.action === _Actions.POP) {\n        var prevIndex = allKeys.indexOf(location.key);\n        var nextIndex = allKeys.indexOf(nextLocation.key);\n\n        if (prevIndex !== -1 && nextIndex !== -1) go(prevIndex - nextIndex); // Restore the URL.\n      }\n    });\n  }\n\n  function push(location) {\n    transitionTo(createLocation(location, _Actions.PUSH, createKey()));\n  }\n\n  function replace(location) {\n    transitionTo(createLocation(location, _Actions.REPLACE, createKey()));\n  }\n\n  function goBack() {\n    go(-1);\n  }\n\n  function goForward() {\n    go(1);\n  }\n\n  function createKey() {\n    return createRandomKey(keyLength);\n  }\n\n  function createPath(location) {\n    if (location == null || typeof location === 'string') return location;\n\n    var pathname = location.pathname;\n    var search = location.search;\n    var hash = location.hash;\n\n    var result = pathname;\n\n    if (search) result += search;\n\n    if (hash) result += hash;\n\n    return result;\n  }\n\n  function createHref(location) {\n    return createPath(location);\n  }\n\n  function createLocation(location, action) {\n    var key = arguments.length <= 2 || arguments[2] === undefined ? createKey() : arguments[2];\n\n    if (typeof action === 'object') {\n      //warning(\n      //  false,\n      //  'The state (2nd) argument to history.createLocation is deprecated; use a ' +\n      //  'location descriptor instead'\n      //)\n\n      if (typeof location === 'string') location = _parsePath2['default'](location);\n\n      location = _extends({}, location, { state: action });\n\n      action = key;\n      key = arguments[3] || createKey();\n    }\n\n    return _createLocation3['default'](location, action, key);\n  }\n\n  // deprecated\n  function setState(state) {\n    if (location) {\n      updateLocationState(location, state);\n      updateLocation(location);\n    } else {\n      updateLocationState(getCurrentLocation(), state);\n    }\n  }\n\n  function updateLocationState(location, state) {\n    location.state = _extends({}, location.state, state);\n    saveState(location.key, location.state);\n  }\n\n  // deprecated\n  function registerTransitionHook(hook) {\n    if (transitionHooks.indexOf(hook) === -1) transitionHooks.push(hook);\n  }\n\n  // deprecated\n  function unregisterTransitionHook(hook) {\n    transitionHooks = transitionHooks.filter(function (item) {\n      return item !== hook;\n    });\n  }\n\n  // deprecated\n  function pushState(state, path) {\n    if (typeof path === 'string') path = _parsePath2['default'](path);\n\n    push(_extends({ state: state }, path));\n  }\n\n  // deprecated\n  function replaceState(state, path) {\n    if (typeof path === 'string') path = _parsePath2['default'](path);\n\n    replace(_extends({ state: state }, path));\n  }\n\n  return {\n    listenBefore: listenBefore,\n    listen: listen,\n    transitionTo: transitionTo,\n    push: push,\n    replace: replace,\n    go: go,\n    goBack: goBack,\n    goForward: goForward,\n    createKey: createKey,\n    createPath: createPath,\n    createHref: createHref,\n    createLocation: createLocation,\n\n    setState: _deprecate2['default'](setState, 'setState is deprecated; use location.key to save state instead'),\n    registerTransitionHook: _deprecate2['default'](registerTransitionHook, 'registerTransitionHook is deprecated; use listenBefore instead'),\n    unregisterTransitionHook: _deprecate2['default'](unregisterTransitionHook, 'unregisterTransitionHook is deprecated; use the callback returned from listenBefore instead'),\n    pushState: _deprecate2['default'](pushState, 'pushState is deprecated; use push instead'),\n    replaceState: _deprecate2['default'](replaceState, 'replaceState is deprecated; use replace instead')\n  };\n}\n\nexports['default'] = createHistory;\nmodule.exports = exports['default'];"]},"metadata":{},"sourceType":"script"}